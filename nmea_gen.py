import pyb

uart_gps = pyb.UART(1, 9600)

time = 210200
lat = 4736.0000
lon = 00850.0000
alt = 440.0 

def generate_nmea():
	global time, lat, lon, alt
	ret = '$GPGGA,' + str(time) + ',' + str(lat) + ',N,' + str(lon) + ',E,7,00,0.0,'+ str(alt) +',M,0.0M,,*00\r\n'
	ret += '$GPRMC,210213,A,3806.1182,N,02414.4136,E,10633.1,351.9,190416,5,E,A*4\r\n'
	ret += '$GPGSV,8,1,32,01,88,321,51,02,53,063,23,03,84,228,48,04,84,086,48*75\r\n'
	ret += '$GPGSV,8,2,32,05,33,014,03,06,59,303,29,07,70,272,38,08,69,318,38*7A\r\n'
	ret += '$GPGSV,8,3,32,09,73,153,41,10,47,313,18,11,02,236,00,12,90,100,52*7F\r\n'
	ret += '$GPGSV,8,4,32,13,08,163,-22,14,04,168,00,15,77,089,44,16,59,129,29*56\r\n'
	ret += '$GPGSV,8,5,32,17,81,341,47,18,79,057,45,19,81,036,47,20,01,310,00*7D\r\n'
	ret += '$GPGSV,8,6,32,21,65,294,34,22,80,000,46,23,80,289,46,24,88,134,51*78\r\n'
	ret += '$GPGSV,8,7,32,25,87,323,50,26,07,233,-23,27,90,080,52,28,56,220,27*5A\r\n'
	ret += '$GPGSV,8,8,32,29,11,300,-20,30,32,134,02,31,43,109,14,32,84,280,48*5A\r\n'
	time += 2
	lat += rand_nr()
	lon += rand_nr()
	alt += rand_nr()
	return ret
	
def rand_nr():
	n = pyb.rng()/200000000
	if n > 2.5:
		n = -n + 2.5
	return n

while(True):
	nmea = generate_nmea()
	print(nmea)
	uart_gps.write(nmea)
	pyb.delay(1000)
